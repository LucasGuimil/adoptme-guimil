paths: 
  /api/sessions/register:
    post:
      summary: Create a new user for the application
      tags:
        - Sessions
      requestBody: 
        required: true
        content: 
          application/json:
            schema: 
              $ref: '#components/requestBodies/register'
      responses:
        "200":
          description: User created successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        "400": 
          description: "One or more properties are missing / User already exists"
        "500":
          description: Error trying to register new user.
  /api/sessions/login:
    post:
      summary: Login to a registered profile
      tags:
        - Sessions
      requestBody: 
        required: true
        content: 
          application/json:
            schema: 
              $ref: '#components/requestBodies/login'
      responses:
        "200":
          description: Logged in successfully.
        "400":
          description: Missing parameters or invalid credentials.
        "404":
          description: User not found
        "500":
          description: Error trying to login
  /api/sessions/current:
    get:
      summary: Get information about the user in the current session, using JWT cookie.
      tags:
        - Sessions
      responses:
        "200":
          description: Current user details.
          content: 
            application/json:
              schema: 
                $ref: '#components/schemas/CurrentUserDTO'
        "500":
          description: Error trying to get current session.
  /api/sessions/unprotectedLogin:
    post:
      summary: Login to a registered profile with sensitive information on the token
      tags:
        - Sessions
      requestBody: 
        required: true
        content: 
          application/json:
            schema: 
              $ref: '#components/requestBodies/login'
      responses:
        "200":
          description: Logged in successfully.
        "400":
          description: Missing parameters or invalid credentials.
        "404":
          description: User not found
        "500":
          description: Error trying to login
  /api/sessions/unprotectedCurrent:
    get:
      summary: Get information about the user in the current session, using JWT cookie, and showing the user's sensitive information.
      tags:
        - Sessions
      responses:
        "200":
          description: Current user details.
          content: 
            application/json:
              schema: 
                $ref: '#components/schemas/CurrentUser'
        "500":
          description: Error trying to get current session.

components: 
  schemas: 
    User: 
      type: object
      properties: 
        _id: 
          type: ObjectId
          description: "Autogenerated ID from MongoDB."
        first_name:
          type: string
          description: User's first name
        last_name:
          type: string
          description: User's last name
        email: 
          type: string
          description: Valid email address
        password:
          type: string
          description: User's hashed password
        role: 
          type: string
          description: Role in the application
        pets: 
          type: array
          description: Array with the information of the user's pets
          items: 
            type: string
      example:
        _id: ObjectId("64af3ead2d3a8cac83dfbc34")
        first_name: Jane
        last_name: Smith
        email: example@mail.com
        password: $2b$10$N6GAc47An/WV6f8lkEivAOoF6B0.8F96sIARFYapEK5ujuzPxYhqq
        role: user
        pets: "[]"
    CurrentUserDTO:
      type: object
      properties: 
        name: 
          type: string
          description: User full name
        email: 
          type: string
          description: User's email address
        role: 
          type: string  
          description: User's role in the application
      example: 
        name: Janet Jones
        email: janetjones@mail.com
        role: admin
  requestBodies:
    register: 
      type: object
      properties: 
        first_name: 
          type: string
          description: User's first name
          required: true
        last_name: 
          type: string
          description: User's last name
          required: true
        email: 
          type: string
          description: Valid email address
          required: true
        password:
          type: string
          description: User's new password, before hash.
          required: true
      example: 
        first_name: Jane
        last_name: Smith
        email: newemail@mail.com
        password: 123456
    login:
      properties:
        email: 
          type: string
          description: Valid email address.
          required: true
        password: 
          type: string
          description: User's password.
          required: true
      example: 
        email: newemail@mail.com
        password: 123456
